@model IEnumerable<MvcBitirmeProjesi.Models.Product>

@{
    ViewData["Title"] = "Ürünler";
    var currentSortDirection = ViewBag.SortDirection as string ?? "ASC";
    var nextSortDirection = currentSortDirection == "ASC" ? "DESC" : "ASC";
    var currentSortColumn = ViewBag.SortColumn as string ?? "";
    var searchQuery = ViewBag.SearchQuery as string ?? "";
}

<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="mb-0">Ürün Listesi</h2>
        <a href="#" class="btn btn-success">Yeni Ürün Ekle</a>
    </div>

    <form method="get" class="mb-3">
        <div class="input-group">
            <input type="text" name="searchQuery" class="form-control" placeholder="Ürün ara..." value="@searchQuery" />
            <input type="hidden" name="sortColumn" value="@currentSortColumn" />
            <input type="hidden" name="sortDirection" value="@currentSortDirection" />
            <button type="submit" class="btn btn-primary">Ara</button>
        </div>
    </form>

    <div class="table-responsive">
        <table class="table table-striped table-hover">
            <thead class="table-dark">
                <tr>
                    <th>
                        <a href="?sortColumn=Id&sortDirection=@(currentSortColumn == "Id" && currentSortDirection == "ASC" ? "DESC" : "ASC")&searchQuery=@searchQuery"
                            class="text-light" style="display:flex;justify-content:space-between;align-items:center;">
                            <span style="flex:1;text-align:left;">ID</span>
                            <span style="flex-shrink:0;">@(currentSortColumn == "Id" ? (currentSortDirection == "ASC" ?
                                                                "▲" : "▼") : "")</span>
                        </a>
                    </th>
                    <th>
                        <a href="?sortColumn=Name&sortDirection=@(currentSortColumn == "Name" && currentSortDirection == "ASC" ? "DESC" : "ASC")&searchQuery=@searchQuery"
                            class="text-light" style="display:flex;justify-content:space-between;align-items:center;">
                            <span style="flex:1;text-align:left;">Adı</span>
                            <span style="flex-shrink:0;">@(currentSortColumn == "Name" ? (currentSortDirection == "ASC"
                                                                ? "▲" : "▼") : "")</span>
                        </a>
                    </th>
                    <th>
                        <a href="?sortColumn=Unit&sortDirection=@(currentSortColumn == "Unit" && currentSortDirection == "ASC" ? "DESC" : "ASC")&searchQuery=@searchQuery"
                            class="text-light" style="display:flex;justify-content:space-between;align-items:center;">
                            <span style="flex:1;text-align:left;">Birim</span>
                            <span style="flex-shrink:0;">@(currentSortColumn == "Unit" ? (currentSortDirection == "ASC"
                                                                ? "▲" : "▼") : "")</span>
                        </a>
                    </th>
                    <th>
                        <a href="?sortColumn=Description&sortDirection=@(currentSortColumn == "Description" && currentSortDirection == "ASC" ? "DESC" : "ASC")&searchQuery=@searchQuery"
                            class="text-light" style="display:flex;justify-content:space-between;align-items:center;">
                            <span style="flex:1;text-align:left;">Açıklama</span>
                            <span style="flex-shrink:0;">@(currentSortColumn == "Description" ? (currentSortDirection ==
                                                                "ASC" ? "▲" : "▼") : "")</span>
                        </a>
                    </th>
                    <th>İşlemler</th>
                </tr>
            </thead>
            <tbody>
                @if (Model != null && Model.Any())
                {
                    foreach (var product in Model)
                    {
                        <tr>
                            <td>@product.Id</td>
                            <td>@product.Name</td>
                            <td>@product.Unit</td>
                            <td>@product.Description</td>
                            <td>
                                <div class="btn-group">
                                    <a href="#" class="btn btn-sm btn-warning">Düzenle</a>
                                    <a href="#" class="btn btn-sm btn-danger ms-1">Sil</a>
                                </div>
                            </td>
                        </tr>
                    }
                }
                else
                {
                    <tr>
                        <td colspan="5" class="text-center">Hiç ürün bulunamadı.</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>